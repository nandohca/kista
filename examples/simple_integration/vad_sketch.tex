\documentclass[a4paper,10pt]{article}
\usepackage{tikz}
\usepackage{verbatim}
\usepackage[margin=15mm]{geometry}
\usetikzlibrary{shapes,arrows,fit,calc,positioning}
\usetikzlibrary{decorations.text}
\usetikzlibrary{decorations.pathmorphing}
\usetikzlibrary{backgrounds}
\makeatletter
\tikzset{
  through point/.style={
    to path={%
      \pgfextra{%
        \tikz@scan@one@point\pgfutil@firstofone(\tikztostart)\relax
        \pgfmathsetmacro{\pt@sx}{\pgf@x * 0.03514598035}%
        \pgfmathsetmacro{\pt@sy}{\pgf@y * 0.03514598035}%
        \tikz@scan@one@point\pgfutil@firstofone#1\relax
        \pgfmathsetmacro{\pt@ax}{\pgf@x * 0.03514598035 - \pt@sx}%
        \pgfmathsetmacro{\pt@ay}{\pgf@y * 0.03514598035 - \pt@sy}%
        \tikz@scan@one@point\pgfutil@firstofone(\tikztotarget)\relax
        \pgfmathsetmacro{\pt@ex}{\pgf@x * 0.03514598035 - \pt@sx}%
        \pgfmathsetmacro{\pt@ey}{\pgf@y * 0.03514598035 - \pt@sy}%
        \pgfmathsetmacro{\pt@len}{\pt@ex * \pt@ex + \pt@ey * \pt@ey}%
        \pgfmathsetmacro{\pt@t}{(\pt@ax * \pt@ex + \pt@ay *           \pt@ey)/\pt@len}%
        \pgfmathsetmacro{\pt@t}{(\pt@t > .5 ? 1 - \pt@t : \pt@t)}%
        \pgfmathsetmacro{\pt@h}{(\pt@ax * \pt@ey - \pt@ay *           \pt@ex)/\pt@len}%
        \pgfmathsetmacro{\pt@y}{\pt@h/(3 * \pt@t * (1 - \pt@t))}%
      }
      (\tikztostart) .. controls +(\pt@t * \pt@ex + \pt@y * \pt@ey, \pt@t * \pt@ey - \pt@y * \pt@ex) and +(-\pt@t * \pt@ex + \pt@y * \pt@ey, -\pt@t * \pt@ey - \pt@y * \pt@ex) .. (\tikztotarget)
    }
  }
}
\makeatother
\begin{document}
File created by KisTA library

Author: F.Herrera

Institution: KTH (2012-2014, Jul), Univ. of Cantabria (from 2014, Sept.)

Rights reserved by the authors in the terms defined by the KisTA license.

KisTA library compilation date: Jul 12 2016 at 10:35:47.



Sketch Creation: Wed Sep 14 18:26:04 2016


Sketch options enabled:
draw system level connections, draw environment box, draw system box, scale = 1
\hfill


\tikzstyle{task_style}=[circle, thick, draw=orange!80, fill=orange!25]
\tikzstyle{logic_link_style} = [->, >=latex', shorten >=1pt]
\tikzstyle{fifo_buffer_style} = [->, >=latex', shorten >=1pt, thick]
\tikzstyle{task_map_arrow} = [dashed, ->, draw=orange!80, fill=orange!80, >=latex', shorten >=1pt, thick]
\tikzstyle{sched_style} = [rectangle, draw=red!80, fill=red!20, rounded corners, thick]
\tikzstyle{sched_map_arrow} = [dashed, ->, draw=red!80, fill=red!80, >=latex', shorten >=1pt, thick]
\tikzstyle{pe_style} = [rectangle, draw=blue!50, fill=blue!20, thick]
\tikzstyle{phy_commres_style} = [cloud, draw=blue!50, fill=blue!10, thick]
\tikzstyle{tdma_bus_style} = [rectangle, draw=blue!50, fill=blue!10, thick]
\tikzstyle{platform_conn_style} = [blue!50, >=latex', shorten >=1pt]
\tikzstyle{mem_style} = [rectangle, draw=blue!50,  fill=blue!5, thick]
\tikzstyle{env_box_st} = [draw=green, fill=green!10, very thick, rectangle, rounded corners, inner sep=10pt, inner ysep=10pt]
\tikzstyle{sys_box_st} = [draw=black, fill=black!10, very thick, rectangle, rounded corners, inner sep=10pt, inner ysep=10pt]
% Use the scale factor for changing the size of the figure and better export to png
% You can set if from KisTA with set_scale method, or by editing this .tex file
\begin{tikzpicture}[scale=1, transform shape]
\node (BE1) [task_style] {$BE1$};
\node (BE2) [task_style, right=of BE1] {$BE2$};
\node (D1_IN) [task_style, right=of BE2] {$D1_IN$};
\node (D1_OUT) [task_style, right=of D1_IN] {$D1_OUT$};
\node (D2_IN) [task_style, right=of D1_OUT] {$D2_IN$};
\node (D2_OUT) [task_style, right=of D2_IN] {$D2_OUT$};
\node (T1) [task_style, right=of D2_OUT] {$T1$};
\node (T2) [task_style, right=of T1] {$T2$};
\node (T3) [task_style, right=of T2] {$T3$};
\node (sched1) [sched_style, below=of BE1] {$sched1$};
\node (sched2) [sched_style, right=of sched1] {$sched2$};
\node (sched3) [sched_style, right=of sched2] {$sched3$};

\node (PE1) [pe_style, below=of sched1] {$PE1$};
\node (PE2) [pe_style, right=of PE1] {$PE2$};
\node (PE3) [pe_style, right=of PE2] {$PE3$};

\node (tdma1) [tdma_bus_style, below=of PE1] {$tdma1$};

\draw (T1) [fifo_buffer_style, postaction={decorate,decoration={text along path,text align=center,text={$fifo2{\;}$}}}] to[out=30,in=150] (T2);
\draw (D1_IN) [fifo_buffer_style, postaction={decorate,decoration={text along path,text align=center,text={$fifo1{\;}$}}}] to[out=30,in=150] (T1);
\draw (BE2.south) [task_map_arrow] -- (sched1.north);
\draw (D1_IN.south) [task_map_arrow] -- (sched1.north);
\draw (D1_OUT.south) [task_map_arrow] -- (sched1.north);
\draw (T1.south) [task_map_arrow] -- (sched1.north);
\draw (T2.south) [task_map_arrow] -- (sched1.north);
\draw (D2_IN.south) [task_map_arrow] -- (sched2.north);
\draw (D2_OUT.south) [task_map_arrow] -- (sched2.north);
\draw (T3.south) [task_map_arrow] -- (sched2.north);
\draw (BE1.south) [task_map_arrow] -- (sched3.north);

\draw (sched1.south) [sched_map_arrow] -- (PE1.north);
\draw (sched2.south) [sched_map_arrow] -- (PE2.north);
\draw (sched3.south) [sched_map_arrow] -- (PE3.north);

\draw (PE1.south) [platform_conn_style] -- (tdma1.north);
\draw (PE2.south) [platform_conn_style] -- (tdma1.north);
\draw (PE3.south) [platform_conn_style] -- (tdma1.north);
\begin{scope}[on background layer]
\node[env_box_st,fit = ] (env_box) {};
\end{scope}
\node [right=of env_box] {$Environment$};
\begin{scope}[on background layer]
\node[sys_box_st,fit = (BE1)(BE2)(D1_IN)(D1_OUT)(D2_IN)(D2_OUT)(T1)(T2)(T3)(sched1)(sched2)(sched3)(PE1)(PE2)(PE3)(tdma1)] (sys_box) {};
\end{scope}
\node [right=of sys_box] {$System$};
 
\end{tikzpicture}
\end{document}

